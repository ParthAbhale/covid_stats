import { useEffect, useState } from "react";
import { fetchCountriesData } from "../services/covidApi";
import CountrySelector from "../components/CountrySelector";
import StatsCard from "../components/StatsCard";
import StatsTable from "../components/StatsTable";
import ViewToggle from "../components/ViewToggle";
import "./Dashboard.css";

export default function Dashboard() {
  const [countries, setCountries] = useState([]);
  const [selected, setSelected] = useState(null);
  const [view, setView] = useState("card");

  useEffect(() => {
    fetchCountriesData().then(data => {
      setCountries(data);
      setSelected(data[0]);
    });
  }, []);

  return (
    <div className="dashboard">
      <CountrySelector
        countries={countries}
        onSelect={setSelected}
      />

      <ViewToggle view={view} setView={setView} />

      {selected && (
        view === "card"
          ? <StatsCard data={selected} />
          : <StatsTable data={selected} />
      )}
    </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  );
}